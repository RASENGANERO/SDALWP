!function(e){"function"==typeof define&&define.amd?define("scripts",e):e()}((function(){"use strict";function e(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function t(t){for(var n=1;n<arguments.length;n++){var i=null!=arguments[n]?arguments[n]:{};n%2?e(Object(i),!0).forEach((function(e){u(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):e(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function n(){n=function(){return t};var e,t={},i=Object.prototype,a=i.hasOwnProperty,r=Object.defineProperty||function(e,t,n){e[t]=n.value},o="function"==typeof Symbol?Symbol:{},u=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",l=o.toStringTag||"@@toStringTag";function c(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,n){return e[t]=n}}function d(e,t,n,i){var a=t&&t.prototype instanceof g?t:g,o=Object.create(a.prototype),u=new C(i||[]);return r(o,"_invoke",{value:T(e,n,u)}),o}function p(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=d;var f="suspendedStart",v="suspendedYield",h="executing",m="completed",q={};function g(){}function z(){}function y(){}var w={};c(w,u,(function(){return this}));var j=Object.getPrototypeOf,_=j&&j(j(S([])));_&&_!==i&&a.call(_,u)&&(w=_);var b=y.prototype=g.prototype=Object.create(w);function x(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function k(e,t){function n(i,r,o,u){var s=p(e[i],e,r);if("throw"!==s.type){var l=s.arg,c=l.value;return c&&"object"==typeof c&&a.call(c,"__await")?t.resolve(c.__await).then((function(e){n("next",e,o,u)}),(function(e){n("throw",e,o,u)})):t.resolve(c).then((function(e){l.value=e,o(l)}),(function(e){return n("throw",e,o,u)}))}u(s.arg)}var i;r(this,"_invoke",{value:function(e,a){function r(){return new t((function(t,i){n(e,a,t,i)}))}return i=i?i.then(r,r):r()}})}function T(t,n,i){var a=f;return function(r,o){if(a===h)throw Error("Generator is already running");if(a===m){if("throw"===r)throw o;return{value:e,done:!0}}for(i.method=r,i.arg=o;;){var u=i.delegate;if(u){var s=O(u,i);if(s){if(s===q)continue;return s}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if(a===f)throw a=m,i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);a=h;var l=p(t,n,i);if("normal"===l.type){if(a=i.done?m:v,l.arg===q)continue;return{value:l.arg,done:i.done}}"throw"===l.type&&(a=m,i.method="throw",i.arg=l.arg)}}}function O(t,n){var i=n.method,a=t.iterator[i];if(a===e)return n.delegate=null,"throw"===i&&t.iterator.return&&(n.method="return",n.arg=e,O(t,n),"throw"===n.method)||"return"!==i&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+i+"' method")),q;var r=p(a,t.iterator,n.arg);if("throw"===r.type)return n.method="throw",n.arg=r.arg,n.delegate=null,q;var o=r.arg;return o?o.done?(n[t.resultName]=o.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,q):o:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,q)}function E(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function I(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function C(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(E,this),this.reset(!0)}function S(t){if(t||""===t){var n=t[u];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,r=function n(){for(;++i<t.length;)if(a.call(t,i))return n.value=t[i],n.done=!1,n;return n.value=e,n.done=!0,n};return r.next=r}}throw new TypeError(typeof t+" is not iterable")}return z.prototype=y,r(b,"constructor",{value:y,configurable:!0}),r(y,"constructor",{value:z,configurable:!0}),z.displayName=c(y,l,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===z||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,y):(e.__proto__=y,c(e,l,"GeneratorFunction")),e.prototype=Object.create(b),e},t.awrap=function(e){return{__await:e}},x(k.prototype),c(k.prototype,s,(function(){return this})),t.AsyncIterator=k,t.async=function(e,n,i,a,r){void 0===r&&(r=Promise);var o=new k(d(e,n,i,a),r);return t.isGeneratorFunction(n)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},x(b),c(b,l,"Generator"),c(b,u,(function(){return this})),c(b,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var i in t)n.push(i);return n.reverse(),function e(){for(;n.length;){var i=n.pop();if(i in t)return e.value=i,e.done=!1,e}return e.done=!0,e}},t.values=S,C.prototype={constructor:C,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(I),!t)for(var n in this)"t"===n.charAt(0)&&a.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function i(i,a){return u.type="throw",u.arg=t,n.next=i,a&&(n.method="next",n.arg=e),!!a}for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r],u=o.completion;if("root"===o.tryLoc)return i("end");if(o.tryLoc<=this.prev){var s=a.call(o,"catchLoc"),l=a.call(o,"finallyLoc");if(s&&l){if(this.prev<o.catchLoc)return i(o.catchLoc,!0);if(this.prev<o.finallyLoc)return i(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return i(o.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return i(o.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&a.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var r=i;break}}r&&("break"===e||"continue"===e)&&r.tryLoc<=t&&t<=r.finallyLoc&&(r=null);var o=r?r.completion:{};return o.type=e,o.arg=t,r?(this.method="next",this.next=r.finallyLoc,q):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),q},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),I(n),q}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var i=n.completion;if("throw"===i.type){var a=i.arg;I(n)}return a}}throw Error("illegal catch attempt")},delegateYield:function(t,n,i){return this.delegate={iterator:S(t),resultName:n,nextLoc:i},"next"===this.method&&(this.arg=e),q}},t}function i(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}function a(e,t,n,i,a,r,o){try{var u=e[r](o),s=u.value}catch(e){return void n(e)}u.done?t(s):Promise.resolve(s).then(i,a)}function r(e){return function(){var t=this,n=arguments;return new Promise((function(i,r){var o=e.apply(t,n);function u(e){a(o,i,r,u,s,"next",e)}function s(e){a(o,i,r,u,s,"throw",e)}u(void 0)}))}}function o(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,i(a.key),a)}}function u(e,t,n){return(t=i(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(e,t,n){var i=wp.media.frames.file_frame=wp.media({title:e,button:{text:t},library:{type:"image"},multiple:!1});return i.on("select",n.bind(i)),i}function l(e,t,n){var i=wp.media.frames.file_frame=wp.media({title:e,button:{text:t},library:{type:["video","image"]},multiple:!1});return i.on("select",n.bind(i)),i}function c(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(e.is(":checkbox"))return e.prop("checked")?1:0;if(e.data("is_json")&&e.val()){try{return JSON.parse(e.val())}catch(e){console.error(e)}return t}return e.val()}function d(e){return void 0!==e.data("name")?e.data("name"):void 0!==e.attr("data-name")?e.attr("data-name"):void 0}var p=window.quizleScriptOptions||{};jQuery((function(e){var t;e(document).on("click",".js-quizle-media-browse",(function(t){t.preventDefault();var n=e(this),i=n.parents(".js-quizle-media-uploader"),a=i.find(".js-quizle-media-preview");l(i.data("uploader_title"),i.data("uploader_button_text"),(function(){var t=this.state().get("selection").first().toJSON();if(i.find(".js-quizle-media-value").val(JSON.stringify({id:t.id,url:t.url,type:t.type,title:t.title,position:c(i.find(".js-quizle-media-position"))})),document.dispatchEvent(new CustomEvent("quizle_media_upload",{detail:{attachment:t,url:t.url,$container:i}})),a.length){var r=t.url;"video"===t.type&&(r=p.videoIcon),a.show(),e("<img>").attr("src",r).addClass("js-quizle-media-preview-icon quizle-media-upload__preview-"+t.type).appendTo(a),"video"===t.type&&e("<span>").addClass("js-quizle-media-preview-text quizle-media-upload__preview-text").text(t.title).appendTo(a)}n.hide(),i.find(".js-quizle-media-remove").show()})).open()})),e(document).on("click",".js-quizle-media-remove",(function(t){t.preventDefault();var n=e(this),i=n.parents(".js-quizle-media-uploader");n.hide(),i.find(".js-quizle-media-browse").show(),i.find(".js-quizle-media-preview-icon").remove(),i.find(".js-quizle-media-preview-text").remove(),i.find(".js-quizle-media-value").val(""),i.find(".js-quizle-media-preview").hide(150),document.dispatchEvent(new CustomEvent("quizle_media_remove",{detail:{$container:i}}))})),e(document).on("click",".js-quizle-media-preview",(function(t){t.preventDefault();var n=e(this).parents(".js-quizle-media-uploader"),i=n.find(".js-quizle-media-preview");l(n.data("uploader_title"),n.data("uploader_button_text"),(function(){var t=this.state().get("selection").first().toJSON();if(n.find(".js-quizle-media-value").val(JSON.stringify({id:t.id,url:t.url,type:t.type,title:t.title,position:c(n.find(".js-quizle-media-position"))})),document.dispatchEvent(new CustomEvent("quizle_media_upload",{detail:{attachment:t,url:t.url,$container:n}})),i.length){i.find(".js-quizle-media-preview-icon").remove(),i.find(".js-quizle-media-preview-text").remove();var a=t.url;"video"===t.type&&(a=p.videoIcon),i.show(),e("<img>").attr("src",a).addClass("js-quizle-media-preview-icon quizle-media-upload__preview"+t.type).appendTo(i),"video"===t.type&&e("<span>").addClass("js-quizle-media-preview-text quizle-media-upload__preview-text").text(t.title).appendTo(i)}})).open()})),e(document).on("keyup",".js-quizle-media-host-link",(function(n){clearTimeout(t);var i=e(n.currentTarget),a=i.parents(".js-quizle-media-uploader");t=setTimeout((function(){var e=i.val()?i.val().trim():null;e?(a.find(".js-quizle-media-upload-wrap").hide(),a.find(".js-quizle-media-value").val(JSON.stringify({id:null,url:e,type:"link",title:null,position:c(a.find(".js-quizle-media-position"))})),document.dispatchEvent(new CustomEvent("quizle_media_upload",{detail:{attachment:null,url:e,$container:a}}))):(document.dispatchEvent(new CustomEvent("quizle_media_remove",{detail:{$container:a}})),a.find(".js-quizle-media-value").val(""),a.find(".js-quizle-media-upload-wrap").show())}),250)})),e(document).on("change",".js-quizle-media-position",(function(t){var n=e(this),i=n.parents(".js-quizle-media-uploader"),a=i.find(".js-quizle-media-value"),r=c(a,{});r.position=c(n),a.val(JSON.stringify(r)),document.dispatchEvent(new CustomEvent("quizle_media_upload",{detail:{attachment:r.attachment,url:r.url,$container:i}}))})),e(document).on("click",".js-quizle-image-browse",(function(t){t.preventDefault();var n=e(this),i=n.parents(".js-quizle-image-uploader"),a=i.find(".js-quizle-image-preview");s(i.data("uploader_title"),i.data("uploader_button_text"),(function(){var t=this.state().get("selection").first().toJSON();document.dispatchEvent(new CustomEvent("quizle_image_upload",{detail:{attachment:t,url:t.url,$container:i}})),i.find(".js-quizle-image-url").val(t.url),a.length&&(a.show(),e("<img>").attr("src",t.url).addClass().appendTo(a)),n.hide(),i.find(".js-quizle-image-remove").show()})).open()})),e(document).on("click",".js-quizle-image-remove",(function(t){t.preventDefault();var n=e(this),i=n.parents(".js-quizle-image-uploader");i.find(".js-quizle-image-browse").show(),i.find("img").remove(),i.find(".js-quizle-image-url").val(""),n.hide(),i.find(".js-quizle-image-preview").hide(150),document.dispatchEvent(new CustomEvent("quizle_image_remove",{detail:{$container:i}}))})),e(document).on("click",".js-quizle-image-preview",(function(t){t.preventDefault();var n=e(this).parents(".js-quizle-image-uploader");s(n.data("uploader_title"),n.data("uploader_button_text"),(function(){var e=this.state().get("selection").first().toJSON();document.dispatchEvent(new CustomEvent("quizle_image_upload",{detail:{url:e.url,$container:n}})),n.find(".js-quizle-image-url").val(e.url),n.find("img").attr("src",e.url)})).open()}))})),jQuery((function(e){e(document).on("click",".js-quizle-export",function(){var t=r(n().mark((function t(i){var a,r;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i.preventDefault(),a=e(i.currentTarget),(r=e('<form method="post">')).attr("action",a.data("form_action")),r.append(e('<input type="hidden" name="action">').val(a.data("action"))),r.append(e('<input type="hidden" name="post[]">').val(a.data("post_id"))),r.append(e('<input type="hidden" name="_wpnonce">').val(a.data("nonce"))),e("body").append(r),t.next=10,r.submit();case 10:r.remove();case 11:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}));var f=function(){return e=function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.jQeury=t,this.$container=n,this._timeouts={},this._messages={}},t=[{key:"warning",value:(v=r(n().mark((function e(t){var i,a=arguments;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=a.length>1&&void 0!==a[1]?a[1]:0,e.abrupt("return",this.add(t,"warning",i));case 2:case"end":return e.stop()}}),e,this)}))),function(e){return v.apply(this,arguments)})},{key:"removeWarning",value:(f=r(n().mark((function e(t){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.remove(t,"warning"));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return f.apply(this,arguments)})},{key:"notice",value:(p=r(n().mark((function e(t){var i,a=arguments;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=a.length>1&&void 0!==a[1]?a[1]:0,e.abrupt("return",this.add(t,"notice",i));case 2:case"end":return e.stop()}}),e,this)}))),function(e){return p.apply(this,arguments)})},{key:"removeNotice",value:(d=r(n().mark((function e(t){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.remove(t,"notice"));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return d.apply(this,arguments)})},{key:"error",value:(c=r(n().mark((function e(t){var i,a=arguments;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=a.length>1&&void 0!==a[1]?a[1]:0,e.abrupt("return",this.add(t,"error",i));case 2:case"end":return e.stop()}}),e,this)}))),function(e){return c.apply(this,arguments)})},{key:"removeError",value:(l=r(n().mark((function e(t){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.remove(t,"error"));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return l.apply(this,arguments)})},{key:"add",value:(s=r(n().mark((function e(t){var i,a,r,o,u,s=this,l=arguments;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=l.length>1&&void 0!==l[1]?l[1]:"warning",a=l.length>2&&void 0!==l[2]?l[2]:0,r=this.jQeury,o=r('<div class="quizle-message quizle-message--'+i+'">').text(t),u=[this.stringHash(t),this.stringHash(i)].join(":"),void 0!==this._messages[u]){e.next=13;break}if(this._messages[u]=!0,o.data("hash",u),o.hide(),this.$container.append(o),o.slideDown(150),!(a>0)){e.next=13;break}return e.abrupt("return",new Promise((function(e){clearTimeout(s._timeouts[u]),s._timeouts[u]=setTimeout((function(){s.removeByHash(u).then((function(){return e(u)}))}),a)})));case 13:return e.abrupt("return",u);case 14:case"end":return e.stop()}}),e,this)}))),function(e){return s.apply(this,arguments)})},{key:"remove",value:(u=r(n().mark((function e(t,i){var a;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=[this.stringHash(t),this.stringHash(i)].join(":"),e.abrupt("return",this.removeByHash(a));case 2:case"end":return e.stop()}}),e,this)}))),function(e,t){return u.apply(this,arguments)})},{key:"removeByHash",value:(a=r(n().mark((function e(t){var i,a,r=this;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=this.jQeury,a=[],delete this._messages[t],this.$container.find(".quizle-message").filter((function(e,n){return t===i(n).data("hash")})).each((function(e,t){a.push(new Promise((function(e){i(t).slideUp(150,(function(t){i(t).remove(),e(r)}))})))})),!a.length){e.next=6;break}return e.abrupt("return",Promise.all(a));case 6:return e.abrupt("return",this);case 7:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"stringHash",value:function(e){var t,n=0;if(0===e.length)return n;for(t=0;t<e.length;t++)n=(n<<5)-n+e.charCodeAt(t),n|=0;return n}}],t&&o(e.prototype,t),i&&o(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,i,a,u,s,l,c,d,p,f,v}();function v(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;try{return JSON.parse(e)}catch(e){console.error(e)}return t}function h(){var e={},t={},n={},i={},a=function(e){for(var t=0;t<1e5;t++){var n=Math.random().toString(36).substring(2,10);if(void 0===e[n])return e[n]=n,n}throw"Unable to generate unique id"};return{generateQuestionId:function(){return a(e)},putQuestionId:function(t){e[t]=t},removeQuestionId:function(t){delete e[t]},generateAnswerId:function(){return a(t)},putAnswerId:function(e){t[e]=e},removeAnswerId:function(e){delete t[e]},generateConditionGroupsId:function(){return a(n)},putConditionGroupsId:function(e){n[e]=e},removeConditionGroupsId:function(e){delete n[e]},generateConditionId:function(){return a(i)},putConditionId:function(e){i[e]=i},removeConditionId:function(e){delete i[e]}}}function m(e){var n=window.localStorage,i=t({hideQuestions:{},hideResults:{},boxes:{}},v(n.getItem(e))),a=function(t,a,r,o){o?i[t]["".concat(a,".").concat(r)]=1:delete i[t]["".concat(a,".").concat(r)],n.setItem(e,JSON.stringify(i))},r=function(e,t,n){return void 0!==i[e]["".concat(t,".").concat(n)]&&i[e]["".concat(t,".").concat(n)]};return{setItem:function(t,a){i.boxes[t]=parseInt(a),n.setItem(e,JSON.stringify(i))},getItem:function(e){return void 0!==i.boxes[e]?i.boxes[e]:null},removeItem:function(t){delete i.boxes[t],n.setItem(e,JSON.stringify(i))},hideQuestion:function(e,t){return a("hideQuestions",e,t,!(arguments.length>2&&void 0!==arguments[2])||arguments[2]),this},doHideQuestion:function(e,t){return r("hideQuestions",e,t)},hideResult:function(e,t,n){return a("hideResults",e,t,n),this},doHideResult:function(e,t){return r("hideResults",e,t)}}}jQuery((function(e){var n,i,a,r={CONTACTS:"contacts",VARIABLE:"variable",TEST:"test"},o=quizle_i18n||{},u=window.quizleMetaboxOptions||{},s=window.quizle_metabox_globals||{clone_text:"(clone)"},l=!1,p=!1,q=function(e,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"welcome-description",a=tinyMCEPreInit.mceInit[i],r=new IntersectionObserver((function(n,i){n.forEach((function(n){n.intersectionRatio>0&&(requestIdleCallback((function(){var i=n.target.getAttribute("id"),r=t({},a),o=e("#"+i+"-wrap").find("textarea");r.setup=function(e){e.on("change",(function(){o.val(e.getContent({format:"html"})).trigger("change")}))},r.body_class=r.body_class.replace('id="content"','id="'+i+'"'),wp.editor.initialize(i,{tinymce:r,quicktags:!0,mediaButtons:!0})})),i.unobserve(n.target))}))}));return function(e){n&&document.getElementById(e)&&r.observe(document.getElementById(e))}}(e,s.enable_mce),g=wp.template,z=function(e){var n=g("quizle-question")(t({can_add_conditions:p,can_add_custom_answer:Array.isArray(e.answers)&&e.answers.filter((function(e){return"custom"===e.type})).length},e));return p=!0,n},y=g("quizle-answer"),w=function(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=e(g("quizle-result-content")(t));return i&&he(a,t),n&&me(a),a.get(0)},j=g("quizle-result-redirect-link"),_=function(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=e(g("quizle-result")(t));return n&&(t.redirect_link?r.find(".js-quizle-result-init").replaceWith(e(j(t))):r.find(".js-quizle-result-init").replaceWith(e(w(t,a,i)))),r.get(0)},b=g("quizle-image-uploader"),x=g("quizle-media-uploader"),k=function(e){var n=t({id:P.generateConditionGroupsId()},e);return P.putConditionGroupsId(n.id),g("quizle-conditions-group")(n)},T=function(e){var n=t({id:P.generateConditionId()},e);return P.putConditionId(n.id),g("quizle-condition-item")(n)},O=e(".js-questions-container"),E=e(".js-results-container"),I=e('input[name="quizle-type"]'),C=e('input[name="quizle-questions"]'),S=e('input[name="quizle-results"]'),N=0,D=[],L=!1,A=new m("quizle-state"),P=new h,Q=new f(e,e(".js-quizle-messages")),J={requireResultsOrContacts:o.requireResultsOrContacts};O.on("change","input, textarea, select",(function(t){e(t.target).data("prevent_observe_change")||ye()})),O.on("keyup","input, textarea",(function(t){e(t.target).data("prevent_observe_change")||ye()})),E.on("change","input, textarea, select",we),E.on("keyup","input, textarea",we),Z(I.val()),K(),e(document).on("change",'input[type="checkbox"][name="result-enabled"], input[type="checkbox"][name="contact-enabled"]',(function(e){K()}));var R=!1;if(e("#post").submit((function(){R=!1})),e(document).on("change","#post input, #post select, #post textarea",(function(t){var n,i;R=!0,n=t.currentTarget,(i=e(n)).is(":checkbox")&&e('input[type="checkbox"][data-depends="'+i.attr("name")+'"]').each((function(t,n){var a=e(n),r=!!a.data("depends-value");i.prop("checked")?(a.prop("checked",a.data("checked")),a.attr("disabled",!1)):(a.data("checked",a.prop("checked")),a.prop("checked",r),a.attr("disabled",!0))}))})),e(document).ready((function(){window.onbeforeunload=function(e){if(R){var t="You have not saved your changes.";return(e=e||window.event).preventDefault(),e&&(e.returnValue=t),t}}})),S.val()){var G=v(S.val(),[]);G.forEach((function(t){var n=me(e(_(t,!0,!0,!0)));n.appendTo(E),q("quizle-result-"+t.id),A.doHideResult(e("#post_ID").val(),t.id)&&n.find(".quizle-result__body").hide();var i=t.redirect_link?xe(t.redirect_link):t.title;D.push({label:i,value:t.id})})),N=Y(G)}if(C.val()){var $=v(C.val(),[]);$.forEach((function(t){P.putQuestionId(t.question_id);var n=pe(qe(e(z(t))),t.media),i=n.find(".js-quizle-answers-container");O.append(n),q("quizle-question-"+t.question_id),q("quizle-right-answer-description-"+t.question_id),A.doHideQuestion(e("#post_ID").val(),t.question_id)&&n.find(".quizle-question__body").hide(),ae(t.type)?t.answers.forEach((function(t){P.putAnswerId(t.answer_id);var a=e(y(t));a=ve(a=fe(a,n.find('select[data-name="type"]').val())),i.append(a),ee(a.find(".js-quizle-answer-score-select"),ie(te())?t.value:void 0),ne(te())&&a.find(".js-quizle-answer-score-number").val(t.value)})):ce(n,!1),se(n,re(t.type)),le(n,oe(t.type)),setTimeout((function(){U(n,t,$)}),10)}))}function H(t){if(l!==t){l=t,e('input[name="quizle-has-conditions"]').val(t?1:0);var n=e('input[type="checkbox"][name="random-questions"]');void 0===n.data("_stashed_value")&&n.data("_stashed_value",c(n)),l?n.prop("checked",!1).prop("disabled",!0):n.prop("checked",n.data("_stashed_value")).prop("disabled",!1);var i=e("#view-type");void 0===i.data("_stashed_value")&&i.data("_stashed_value",i.val()),l?i.val("slides").prop("disabled",!0):i.val(i.data("_stashed_value")).prop("disabled",!1)}}function W(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:v(C.val(),[]),n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=[],a=0;a<t.length&&(n||t[a].question_id!==e);a++)i.push({question_id:t[a].question_id,title:t[a].title});return i}function B(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{value:[],compareOptions:{partial:1,caseSensitive:0}},i=t.parents(".js-quizle-condition-item"),a=t.val();if(i.find(".js-quizle-condition-item-options").remove(),a){var r=e('[data-name="question_id"][value="'+a+'"]').parents(".js-quizle-question-item");if(r.length)if(ae(r.find('select[data-name="type"]').val())){var o=[];r.find(".js-quizle-answer-item").each((function(){var t=e(this),n="custom"===t.find(".js-quizle-answer-type").val()?t.find(".js-quizle-answer-custom-text").html():t.find('input[data-name="name"]').val();o.push({name:n,value:t.find(".js-quizle-answer-id").val()})}));for(var s=e('<select data-name="value" multiple class="js-quizle-condition-item-answers">'),l=0;l<o.length;l++){var c=e("<option>").attr("value",o[l].value).text(o[l].name);n.value.includes(o[l].value)&&c.prop("selected",!0),c.appendTo(s)}i.find(".js-quizle-condition-item-answers").replaceWith(s),i.find('input[data-name="compare"]').val("in")}else{var d=e('<input data-name="value" type="text" class="js-quizle-condition-item-answers">');d.val(n.value[0]),i.find(".js-quizle-condition-item-answers").replaceWith(d);var p=e('<label class="js-quizle-condition-item-options"><input type="checkbox" data-name="compare-option-partial" value="1"> '+u.conditions.labelPartial+"</label>");p.find("input").prop("checked",n.compareOptions&&n.compareOptions.partial),p.insertAfter(d);var f=e('<label class="js-quizle-condition-item-options"><input type="checkbox" data-name="compare-option-caseSensitive" value="1"> '+u.conditions.labelCaseSensitive+"</label>");f.find("input").prop("checked",n.compareOptions&&n.compareOptions.caseSensitive),f.insertAfter(p),i.find('input[data-name="compare"]').val("like")}}else i.find(".js-quizle-condition-item-answers").replaceWith(e('<span class="js-quizle-condition-item-answers">(select a question)</span>'))}X(),e(".quizle-box").find(".js-color-picker").wpColorPicker(),e(document).on("click",".js-quizle-type-item",(function(t){if(!e(t.target).hasClass("js-quizle-type-item--doc-link")){t.preventDefault();var n=e(this);e(".js-quizle-type-item").removeClass("checked"),Z(n.data("type"),I.val()),I.val(n.data("type")),n.addClass("checked"),e(".js-quizle-answers-container .js-quizle-answer-item").each((function(){ve(e(this),n.data("type"),!0)})),e(".js-results-container .js-quizle-result-item").each((function(){me(e(this))})),e(".js-quizle-question-item").each((function(){se(e(this))})),be()}})),e(".js-quizle-box-header-action-expand").each((function(){var t=e(this).parents(".quizle-box").find(".quizle-box__body"),n=A.getItem(t.data("identity"));null!==n&&n?(t.show(),t.data("show_state",1)):(t.hide(),t.data("show_state",0))})),e(document).on("click",".js-quizle-box-header-action-expand",(function(){var t=e(this).parents(".quizle-box").find(".quizle-box__body");parseInt(t.data("show_state"))?(t.slideUp(150),t.data("show_state",0)):(t.slideDown(150),t.data("show_state",1)),A.setItem(t.data("identity"),t.data("show_state"))})),e(document).on("click",".js-add-quizle-question",(function(t){t.preventDefault();var n={type:"check",question_id:P.generateQuestionId()},i=e(z(n));ce(i=pe(i=ge(qe(i),"quizle-question--highlight"))),se(i),le(i),e(".js-questions-container").append(i),q("quizle-question-"+n.question_id),q("quizle-right-answer-description-"+n.question_id)})),e(document).on("click",".quizle-question-action--copy",(function(){var t=e(this).parents(".js-quizle-question-item"),n=t.find(".js-quizle-question-id").val(),i=v(C.val(),[]).filter((function(e){return e.question_id===n}))[0];i&&function(t,n){t.title=((t.title?t.title:"")+" "+s.clone_text).trim(),t.question_id=P.generateQuestionId();var i=pe(qe(e(z(t))),t.media),a=i.find(".js-quizle-answers-container");i.insertAfter(n),q("quizle-question-"+t.question_id),q("quizle-right-answer-description-"+t.question_id),A.doHideQuestion(e("#post_ID").val(),t.question_id)&&i.find(".quizle-question__body").hide(),ae(t.type)?t.answers.forEach((function(t){t.answer_id=P.generateAnswerId();var n=e(y(t));n=ve(n=fe(n,i.find('select[data-name="type"]').val())),a.append(n),ee(n.find(".js-quizle-answer-score-select"),ie(te())?t.value:void 0),ne(te())&&n.find(".js-quizle-answer-score-number").val(t.value)})):ce(i,!1),se(i,re(t.type)),le(i,oe(t.type)),t.conditions=t.conditions.map((function(e){return e.id=P.generateConditionGroupsId(),e.conditions=e.conditions.map((function(e){return e.id=P.generateConditionId(),e})),e})),setTimeout((function(){U(i,t)}),10)}(i,t),je()})),e(document).on("click",".quizle-question-action--delete",(function(){if(confirm(e(this).data("confirm"))){var t=e(this).parents(".js-quizle-question-item");P.removeQuestionId(t.find(".js-quizle-question-id").val()),t.remove(),ye(),X()}})),e(document).on("click",".js-quizle-question-action-expand",(function(){var t=e(this).parents(".js-quizle-question-item");t.find(".quizle-question__body").slideToggle(150,(function(){A.hideQuestion(e("#post_ID").val(),t.find(".js-quizle-question-id").val(),!e(this).is(":visible"))}))})),e(document).on("click",".js-quizle-box-header-action-expand-all-questions",(function(t){t.preventDefault();var n=e(t.currentTarget);n.parents(".quizle-box").find(".quizle-question__body").slideUp(150,(function(){var t=e(this).parents(".js-quizle-question-item");A.hideQuestion(e("#post_ID").val(),t.find(".js-quizle-question-id").val(),!0)})),n.blur()})),e(document).on("keyup",".js-quizle-question-name",(function(){var t=e(this);ze((function(){t.parents(".js-quizle-question-item").find(".quizle-question-header__title-additional").text(t.val())}))})),e(document).on("click",".js-add-quizle-answer, .js-add-quizle-custom-answer",(function(t){t.preventDefault();var n=e(this),i=n.parents(".js-quizle-question-item"),a=n.hasClass("js-add-quizle-custom-answer"),r=e(y({answer_id:P.generateAnswerId(),type:a?"custom":"general"}));r=ve(r=fe(r=ge(r,"quizle-answer--highlight"),i.find('select[data-name="type"]').val())),a&&n.hide(),ee(r.find(".js-quizle-answer-score-select")),n.parents(".js-quizle-question-item").find(".js-quizle-answers-container").append(r),F(i,"changed_answer")})),e(document).on("click",".quizle-answer-action--delete",(function(t){if(confirm(e(this).data("confirm"))){var n=e(this),i=n.parents(".js-quizle-answer-item"),a=n.parents(".js-quizle-question-item");P.removeAnswerId(i.find(".js-quizle-answer-id").val()),i.remove(),je(),X(),F(a,"changed_answer"),"custom"===i.find(".js-quizle-answer-type").val()&&a.find(".js-add-quizle-custom-answer").show()}})),e(document).on("change",'.js-quizle-question-item select[data-name="type"]',(function(){var t=e(this),n=t.val(),i=t.parents(".js-quizle-question-item");ce(i,ae(n)),se(i,re(n)),le(i,oe(n)),i.find(".js-quizle-answer-item").each((function(){var t=e(this).find(".js-quizle-answer-image");de(n)?t.children().length||e(b({name:"image",url:t.attr("data-image")})).appendTo(t):t.children().slideUp(50,(function(){e(this).remove()}))}))})),e(document).on("quizle_image_upload",(function(e){e.detail.$container.parent(".js-quizle-answer-image").attr("data-image",e.detail.url),ye(),we()})),e(document).on("quizle_media_upload",(function(e){ye()})),e(document).on("quizle_image_remove",(function(e){e.detail.$container.parent(".js-quizle-answer-image").attr("data-image",""),ye(),we()})),e(document).on("quizle_media_remove",(function(e){ye()})),e(document).on("keyup",".js-quizle-result-title",(function(){var t=e(this);ze((function(){t.parents(".js-quizle-result-item").find(".quizle-result-header__title-additional").text(t.val())}))})),e(document).on("click",".js-quizle-result-action-expand",(function(){e(this).parents(".quizle-result").find(".quizle-result__body").slideToggle(150,(function(){var t=e(this);A.hideResult(e("#post_ID").val(),t.parents(".js-quizle-result-item").find('input[data-name="id"]').val(),!t.is(":visible"))}))})),e(document).on("click",".js-quizle-box-header-action-expand-all-results",(function(t){t.preventDefault();var n=e(t.currentTarget);n.parents(".quizle-box").find(".quizle-result__body").slideUp(150,(function(){A.hideResult(e("#post_ID").val(),e(this).parents(".js-quizle-result-item").find('input[data-name="id"]').val(),!0)})),n.blur()})),e(document).on("click",".quizle-result-action--copy",(function(){var t,n,i,a=e(this).parents(".quizle-result");t=a.find('input[data-name="id"]').val(),n=a,(i=v(S.val(),[]).filter((function(e){return e.id===t}))[0])&&(N++,i.id=N,i.title=((i.title?i.title:"")+" "+s.clone_text).trim(),ge(me(he(e(_(i,!0,!0)))).insertAfter(n),"quizle-result--highlight"),q("quizle-result-"+i.id))})),e(document).on("click",".quizle-result-action--delete",(function(){confirm(e(this).data("confirm"))&&(e(this).parents(".js-quizle-result-item").remove(),be())})),e(document).on("click",".js-add-quizle-result",(function(){N++,me(he(e(_({id:N})))).appendTo(E),e('input[type="checkbox"][name="result-enabled"]').prop("checked",!0)})),e(document).on("change",".js-quizle-answer-score-number, .js-quizle-answer-score-select",(function(){var t=e(this);t.parents(".js-quizle-answer-item").find('input[data-name="value"]').val(t.val()),t.hasClass("js-quizle-answer-score-number")&&ue(te())&&X()})),e(document).on("change",".js-quizle-is-multiple-checkbox input, .js-quizle-is-required-checkbox input",X),e(document).on("click",".js-quizle-result-init button",(function(t){t.preventDefault();var n=e(t.currentTarget),i=n.parents(".js-quizle-result-item").find('input[data-name="id"]').val();"content"===n.data("result_type")&&(n.parents(".js-quizle-result-init").replaceWith(w({id:i},!0,!0)),q("quizle-result-"+i)),"redirect_link"===n.data("result_type")&&n.parents(".js-quizle-result-init").replaceWith(me(e(j({}))))})),e(document).on("click",".js-quizle-question--add-conditions",(function(t){t.preventDefault();var n=e(t.currentTarget);if(!n.hasClass("disabled")){n.parents(".js-quizle-question-item").addClass("has-conditions");var i=u.conditions.types[0]||{},a=i.text,r=i.value,o=u.conditions.relations[0]||{},s=o.text,l=o.value;e(k({type_text:a,type:r,relation_text:s,relation:l})).hide().appendTo(n.parents(".quizle-question-conditions")).fadeIn(150)}})),e(document).on("click",".js-quizle-question--remove-conditions",(function(t){t.preventDefault();var n=e(t.currentTarget),i=n.parents(".js-quizle-question-item");n.parents(".quizle-question-conditions__container").fadeOut(150,(function(){e(this).remove(),i.find(".js-quizle-question-conditions").length||i.removeClass("has-conditions"),je()}))})),e(document).on("click",".js-quizle-question--add-condition-item",(function(t){t.preventDefault();var n=e(t.currentTarget);if(!n.hasClass("disabled")){var i=n.parents(".js-quizle-question-conditions"),a=0;i.find(".js-quizle-condition-item-idx").each((function(){var t=parseInt(e(this).text());!isNaN(t)&&t>a&&(a=t)})),a++,e(T({idx:a,compare:"in",questions:W(n.parents(".js-quizle-question-item").find(".js-quizle-question-id").val())})).hide().appendTo(i.find(".quizle-question-conditions__body")).fadeIn(150)}})),e(document).on("change",".js-quizle-condition-item-question",(function(t){B(e(t.currentTarget))})),e(document).on("click",".js-quizle-question--remove-condition-item",(function(t){t.preventDefault();var n=e(t.currentTarget),i=n.parents(".js-quizle-question-conditions");n.parents(".js-quizle-condition-item").fadeOut(159,(function(){e(this).remove(),je();var t=1;i.find(".js-quizle-condition-item-idx").each((function(){e(this).text(t++)}))}))})),e(document).on("click",".js-quizle-question-conditions-type",(function(t){var n=e(t.currentTarget),i=n.parents(".js-quizle-question-conditions").find('.js-quizle-question-conditions-inputs input[data-name="type"]'),a=i.val(),r=u.conditions.types.filter((function(e){return e.value!==a}))[0];r&&(i.val(r.value),n.text(r.text),je())})),e(document).on("click",".js-quizle-question-conditions-relation",(function(t){var n=e(t.currentTarget),i=n.parents(".js-quizle-question-conditions").find('.js-quizle-question-conditions-inputs input[data-name="relation"]'),a=i.val(),r=u.conditions.relations.filter((function(e){return e.value!==a}))[0];r&&(i.val(r.value),n.text(r.text),je())}));var M,V=null;function U(n,i){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:v(C.val(),[]);Array.isArray(i.conditions)&&i.conditions.forEach((function(r){if(r.conditions.length){var o=(u.conditions.types.filter((function(e){return e.value===r.type}))[0]||{}).text,s=(u.conditions.relations.filter((function(e){return e.value===r.relation}))[0]||{}).text,l=e(k(t({type_text:o,relation_text:s},r))),c=l.find(".quizle-question-conditions__body");l.appendTo(n.find(".quizle-question-conditions"));var d=1;r.conditions.forEach((function(r){H(!0),n.addClass("has-conditions");var o=e(T(t({idx:d++,questions:W(i.question_id,a,r.disabled)},r)));o.appendTo(c);var u=o.find(".js-quizle-condition-item-question");u.val(r.target),B(u,r)}))}}))}function F(n,i){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.find(".js-quizle-question-id").val(),o=e(".js-quizle-question-item.has-conditions");if(o.length)switch(i){case"changed_question_type":var u=a.curValue,s=a.prevValue;if(ae(u)===ae(s))return;o.each((function(){e(this).find(".js-quizle-condition-item-question").each((function(){var t=e(this);if(t.val()===r){var n=t.parents(".js-quizle-condition-item");B(n.find(".js-quizle-condition-item-question")),n.find(".js-quizle-condition-item-changed").show()}}))})),je();break;case"changed_answer":case"changed_question":var l=a.markChanged,c=void 0===l?1:l,d=function(t){var n=[];return t.find(".js-quizle-condition-item-question option").each((function(){var t=e(this).attr("value");if(t){var i=e('input[data-name="question_id"][value="'+t+'"]').parents(".js-quizle-question-item");n.push({question_id:t,title:i.find(".js-quizle-question-name").val()})}})),n};o.each((function(){e(this).find(".js-quizle-condition-item-question").each((function(){var n=e(this);if(n.val()===r){var i=n.parents(".js-quizle-condition-item"),a=t({_changed:c},_e(i)),o=e(T(t(t({},a),{},{questions:d(i)})));i.replaceWith(o),B(o.find(".js-quizle-condition-item-question").val(a.target),a)}}))})),je()}}function Y(e){return e.map((function(e){var t=parseInt(e.id);return isNaN(t)?0:t})).reduce((function(e,t){return Math.max(e,t)}),0)}function K(){e('input[type="checkbox"][name="result-enabled"]').is(":checked")||e('input[type="checkbox"][name="contact-enabled"]').is(":checked")?Q.removeWarning(J.requireResultsOrContacts):Q.warning(J.requireResultsOrContacts)}function X(){if(r.TEST===te()){var t=0,n=0;e(".js-quizle-question-item").each((function(i,a){var r=e(a),o=[];r.find(".js-quizle-answer-item").each((function(){var t=e(this),n=parseInt(t.find('input[data-name="value"]').val());o.push(isNaN(n)?0:n)})),o.length&&(r.find('input[data-name="required"]').is(":checked")&&(t+=Math.min.apply(Math,o)),r.find('input[data-name="is_multiple"]').is(":checked")?n+=o.reduce((function(e,t){return t+e}),0):n+=Math.max.apply(Math,o))})),e(".js-result-min-max-value .js-result-min-value").text(t),e(".js-result-min-max-value .js-result-max-value").text(n)}}function Z(t,n){var i=e('input[type="checkbox"][name="contact-enabled"]'),a=i.parent(),o=i.data("prev_state_checked");t!==n&&(n===r.CONTACTS&&(i.removeData("prev_state_checked"),a.find('input[type="hidden"]').val(0),i.attr("disabled",!1),a.removeClass("disabled"),void 0!==o&&i.prop("checked",o)),t===r.CONTACTS&&(i.data("prev_state_checked",i.is(":checked")?1:0),i.prop("checked",!0),i.attr("disabled",!0),a.find('input[type="hidden"]').val(1),a.addClass("disabled")),K())}function ee(t,n){t.find("option").remove(),t.append(e("<option>").attr("value","").text(t.data("empty_opt_text")));var i=[];D.forEach((function(n){i.push(n.value),t.append(e("<option>").attr("value",n.value).text(n.label))})),t.val(i.includes(n)?n:"")}function te(){return I.val()}function ne(e){return e===r.TEST}function ie(e){return e===r.VARIABLE}function ae(e){switch(e){case"text":case"textarea":case"file":return!1;default:return!0}}function re(e){if(r.TEST===te())switch(e){case"text":case"textarea":case"file":return!1;default:return!0}return!1}function oe(e){switch(e){case"text":case"textarea":case"file":return!1;default:return!0}}function ue(e){return e===r.TEST}function se(e,t){void 0===t&&(t=re(e.find('select[data-name="type"]').val())),t?e.find(".js-question-right-answer-description").show():e.find(".js-question-right-answer-description").hide()}function le(e,t){void 0===t&&(t=oe(e.find('select[data-name="type"]').val())),t?e.find(".js-question-columns").show():e.find(".js-question-columns").hide()}function ce(e,t){void 0===t&&(t=ae(e.find('select[data-name="type"]').val())),t?(e.find(".quizle-answers").show(),e.find(".js-add-quizle-answer").show(),e.find(".js-quizle-is-multiple-checkbox").show()):(e.find(".quizle-answers").hide(),e.find(".js-add-quizle-answer").hide(),e.find(".js-quizle-is-multiple-checkbox").hide())}function de(e){switch(e){case"image_horizontal":case"image_vertical":return!0;default:return!1}}function pe(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=t.find(".js-quizle-question-media");return e(x({size:"large",name:"media",media:n})).appendTo(i),t}function fe(t,n){if(de(n)){var i=t.find(".js-quizle-answer-image");e(b({name:"image",url:i.attr("data-image")})).appendTo(i)}return t}function ve(e,t,n){void 0===t&&(t=te()),e.find(".js-quizle-answer-score-number, .js-quizle-answer-score-select").hide();var i="";return ne(t)?i=e.find(".js-quizle-answer-score-number").show().val():ie(t)&&(i=e.find(".js-quizle-answer-score-select").show().val()),void 0!==n&&n&&e.find('input[data-name="value"]').val(i),e}function he(t,n){return n=void 0===n?{image:""}:n,t.find(".js-image-upload-placeholder").replaceWith(e(b({name:"image",url:n.image,size:"medium"}))),t}function me(e,t){return void 0===t&&(t=te()),ue(t)?e.find(".js-result-min-max-value").show():e.find(".js-result-min-max-value").hide(),e}function qe(e){return e.find(".js-quizle-answers-container").sortable({axis:"y",handle:".quizle-answer__move",update:ye}),e}function ge(e,t){return setTimeout((function(){e.addClass(t)}),50),setTimeout((function(){e.removeClass(t)}),450),e}function ze(e,t){t=void 0===t?200:t,clearTimeout(a),a=setTimeout(e,t)}function ye(){clearTimeout(n),e("#publish").attr("disabled",!0),n=setTimeout((function(){je(),e("#publish").attr("disabled",!1)}),200)}function we(){clearTimeout(i),e("#publish").attr("disabled",!0),i=setTimeout((function(){be(),e("#publish").attr("disabled",!1)}),50)}function je(){var t=[],n=!1;O.find(".js-quizle-question-item").each((function(){var i=e(this),a={answers:[],conditions:[]};i.find(".js-quizle-answer-item").each((function(){var t,n;a.answers.push((t=e(this),n={},t.find("input, textarea, select").not(":button, :submit, :reset").each((function(){var t=e(this),i=d(t);void 0!==i&&i.length&&(n[i]=c(t),t.data("_exclude_from_questions_json",1))})),n))})),i.find(".js-quizle-question-conditions").each((function(){var t,i;(t=e(this),i=[],t.each((function(){var t=e(this),n={type:t.find('input[data-name="type"]').data("_exclude_from_questions_json",1).val(),relation:t.find('input[data-name="relation"]').data("_exclude_from_questions_json",1).val()},a=n.type,r=void 0===a?"show":a,o=n.relation,u={type:r,relation:void 0===o?"AND":o,conditions:[]};t.find(".js-quizle-condition-item").each((function(){u.conditions.push(_e(e(this)))})),i.push(u)})),i).forEach((function(e){e.conditions.length&&(a.conditions.push(e),n=!0)}))})),i.find("input, textarea, select").not(":button, :submit, :reset").filter((function(){return!e(this).data("_exclude_from_questions_json")})).each((function(){var t=e(this),n=d(t);void 0!==n&&n.length&&(a[n]=c(t))})),ae(a.type)||(a.answers=[]),re(a.type)||(a.right_answer_description=""),t.push(a)})),H(n),C.val(JSON.stringify(t)),console.log("questions",t)}function _e(t){var n={};return t.find("input,textarea,select").not(":button, :submit, :reset").each((function(){var t=e(this),i=d(t);if(t.data("_exclude_from_questions_json",1),void 0!==i&&i.length){var a=c(t);if("compare-option-"===i.substring(0,15)){var r=n.compareOptions,o=void 0===r?{}:r;o[i.substring(15)]=a,n.compareOptions=o}else n[i]="value"===i?Array.isArray(a)?a:[a]:a}})),n}function be(){var t=[];E.find(".js-quizle-result-item").each((function(){var n={};e(this).find("input, textarea, select").not(":button, :submit, :reset").each((function(){var t=e(this),i=d(t);void 0!==i&&i.length&&(n[i]=c(t))})),L=L||n.hasOwnProperty("redirect_link"),t.push(n)})),S.val(JSON.stringify(t)),document.dispatchEvent(new CustomEvent("quizle_save_results",{detail:t})),console.log("results",t)}function xe(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:24;return e?e.length>t?"redirect: ".concat(e.substring(0,t).concat("...")):"redirect: ".concat(e.substring(0,t)):null}e(document).on("focus",".js-quizle-question-type",(function(t){V=e(t.currentTarget).val()})).on("change",".js-quizle-question-type",(function(t){var n=e(t.currentTarget);n.blur(),F(n.parents(".js-quizle-question-item"),"changed_question_type",{curValue:n.val(),prevValue:V})})),e(document).on("change",".js-quizle-condition-item input, .js-quizle-condition-item select, .js-quizle-condition-item textarea",(function(t){e(t.currentTarget).parents(".js-quizle-condition-item").find(".js-quizle-condition-item-changed").hide()})),e(document).on("keyup",'.js-quizle-answer-item input[data-name="name"]',(function(t){clearTimeout(M);var n=e(t.currentTarget).parents(".js-quizle-question-item");M=setTimeout((function(){F(n,"changed_answer",{markChanged:0})}),150)})),e(document).on("keyup",'.js-quizle-question-item input[data-name="title"]',(function(t){clearTimeout(M);var n=e(t.currentTarget).parents(".js-quizle-question-item");M=setTimeout((function(){F(n,"changed_question",{markChanged:0})}),150)})),O.sortable({axis:"y",handle:".quizle-question-header__move",update:function(){je(),e(".js-quizle-question--add-conditions").show().first().hide(),e(".js-quizle-question-item").each((function(){var t=e(this),n=t.find(".js-quizle-condition-item");if(n.length){var i=W(t.find(".js-quizle-question-id").val()).map((function(e){return e.question_id}));n.each((function(){var t=e(this),n=t.find(".js-quizle-condition-item-question").val();n&&function(e){arguments.length>1&&void 0!==arguments[1]&&!arguments[1]?(e.find(".quizle-question-condition-item__overlay").hide(),e.find('input[data-name="disabled"]').val(0)):(e.find('input[data-name="disabled"]').val(1),e.find(".quizle-question-condition-item__overlay").show())}(t,!i.includes(n))}))}})),je()}}),E.sortable({axis:"y",handle:".quizle-result-header__move",update:be}),e(document).on("quizle_save_results",(function(t){N=Y(t.detail),D=t.detail.map((function(e){return{label:e.redirect_link?xe(e.redirect_link):e.title,value:e.id}})),e(".js-quizle-answer-item").each((function(){var t=e(this),n=t.find('input[data-name="value"]'),i=t.find(".js-quizle-answer-score-select"),a=i.val();ee(i,a),i.is(":visible")&&n.val(i.val())}))}))}))}));